var checkBoxHtml;var globalButtonIndex=1;var ppIdFromBrowse="";function createMonogrammingModalURL(c){var d=$("#monogramCheck"+c).attr("checked");if(d==true){$("#linkForMonogramModal"+c).trigger("click");$("#monogramCheck"+c).attr("checked",false);}}function getDynamicComponentsOrAddMonogram(g,e){removeErrorClass("2");
if(e=="changeComponentOption"){var h=g.selectedIndex;var f=g.options[h].id;$("#componentOptionId").val(f);}$("#action").val(e);$("#dontLoadFromCommerceItem").val(true);submitVdataForm();}function getDynamicComponentsForHemming(h,f,k){var j=h.selectedIndex;var g=h.options[j].id;if(g!=""){if(f=="changeComponentOption"){$("#componentOptionId").val(g);
$("#dontLoadFromCommerceItem").val(true);}validateHemming(k,f);}}function submitVdataForm(){var b={success:renderAjaxResponse,error:error};$("#product_details").ajaxSubmit(b);}function renderAjaxResponse(n,s){var p=$(n).find(".monogram_dynamic_content");if($(p).length>0){var k=$(p).html();var m=$(p).find("div[id='dynamicContentFlag']").html();
if(m=="true"){$(".monogram_dynamic_content").html(k);$.colorbox.resize();}}else{if(n.errorPresent=="true"){$("#errorContainer_modal").html(n.errorMessages);var l=n.errorComponents.split("_");for(var o=0;o<l.length;o++){$("#enterValueFor"+l[o]).addClass("error");$("#selectOptions"+l[o]).addClass("error");
}$.colorbox.resize();$("div#errorContainer_modal").scrollTop();}else{$("#cboxClose").trigger("click");var r=n.productPresentationId;if(r==null){r="";}var q=n.monogramConfirmation;checkBoxHtml=n.monogramCheckBoxHtml;$("#monogramForConfirm"+r).html(q);$("#monogramCheckBox"+r).empty();$("#monogramFor"+r).empty();
$("html, body").animate({scrollTop:$("div#monogarm_title"+r).offset().top},750);}}}function removeConfirmation(b){if(confirm("This will remove all entered information. Are you sure?")==false){return;}$("#monogramForConfirm"+b).empty();if(b==null){b="";}if(checkBoxHtml==null){$("#monogramConfirmationForShppingBag").empty();
$("#monogramCheckBoxForShoppingBag").show();}else{$("#monogramConfirmationForShppingBag").empty();$("#monogramCheckBoxForShoppingBag").empty();$("#monogramCheckBox"+b).html(checkBoxHtml);}}function editMonogramDetails(b){$("#openEditMonogramModal_"+b).trigger("click");}function prepopulateMonogramData(j){if(j==""||!j){if($("#components").val()!=""&&$("#componentValues").val()!=""){var g=$("#components").val().split(",");
var h=$("#componentValues").val().split(",");var e=g.length;try{$('div[id*="component"]').each(function(a){var b=false;var c;temp=this.id;componentId=temp.substring(9);for(i=0;i<e;i++){if(componentId==g[i]){b=true;c=i;break;}}if(b==false){$(this).remove();}else{if($("#selectOptions"+componentId).length>0){var f=h[c].replace(/_/g," ");
$("#selectOptions"+componentId).val(f).attr("selected","selected");}else{var d=h[c].replace(/_/g," ");$("#enterValueFor"+componentId).val(d);}}});}catch(k){handlejavaScriptError(k);}}}}function closeModal(){$("#cboxClose").trigger("click");}function calculatePrice(e){showSpinner("grid_16");$("#made_to_measure_form"+e).find("input").each(function(){$(this).removeClass("error");
});$("#made_to_measure_form"+e).find("select").each(function(){$(this).removeClass("error");});$("#quantityForMTM"+e).removeClass("error");$("#errorContainer1").hide();$("#errorContainer2").hide();var d={success:displayConfirmationPage,error:error};var f=jQuery.trim($("#madeToMeasureConfirmationFragment"+e).html());
if(f.length>0){$("#madeToMeasureConfirmationFragment"+e).empty();}$("#dontLoadFromCommerceItem").val(true);$("#made_to_measure_form"+e).attr("action","");$("#made_to_measure_form"+e).ajaxSubmit(d);}function displayConfirmationPage(k){var j=k.ppId;$("#colorErrorContainerForMTM"+j).hide();$("#colorErrorContainerForMTM"+j+"#errorMessagesUL").empty();
var p=k.isValidationErrorsPresent;if(p=="true"){var l=k.html;$("#colorErrorContainerForMTM"+j).show();$("#colorErrorContainerForMTM"+j).find("#errorContainer").show();$("#made_to_measure_lotskuSelection"+j).show();$("#madeToMeasureConfirmationFragment"+j).hide();if(!checkForMTMColor(j)){l=l+"<li>select a color</li>";
}$("#colorErrorContainerForMTM"+j).find("#errorMessagesUL").html(l);var q=k.errorComponents.split("_");if(q!=""){for(var m=0;m<q.length;m++){$('[name$="'+q[m]+"\"]'").each(function(){$(this).addClass("error");});}}var n=/[1-9]\d?/;var o=$("#quantityForMTM"+j).val();if(!n.test(o)){$("#quantityForMTM"+j).addClass("error");
}$("html, body").animate({scrollTop:$("div#colorErrorContainerForMTM"+j).offset().top},750);ensembleMTMError=true;}else{if(!checkForMTMColor(j)){$("#made_to_measure_lotskuSelection"+j).show();$("#madeToMeasureConfirmationFragment"+j).hide();$("#colorErrorContainerForMTM"+j).show();$("#colorErrorContainerForMTM"+j).find("#errorContainer").show();
$("#colorErrorContainerForMTM"+j).find("#errorMessagesUL").html("<li>select a color</li>");$("html, body").animate({scrollTop:$("div#colorErrorContainerForMTM"+j).offset().top},750);ensembleMTMError=true;}else{$("#productOptions"+j).hide();$("#productConfirmation"+j).show();$("#made_to_measure_lotskuSelection"+j).hide();
document.getElementById("productConfirmation"+j).innerHTML=k.html;$("#priceDetails"+k.ppId).html(k.priceForMTM);$("html, body").animate({scrollTop:$("div#productConfirmation"+j).offset().top},10);jcp.toolTipSwatch();}}hideSpinner();}function error(){redirectOnError();}function editProductInformation(b){$("#confirmationDiv"+b).html("false");
$("#madeToMeasureConfirmationFragment"+b).hide();$("#productOptions"+b).show();$("#productConfirmation"+b).hide();$("#made_to_measure_lotskuSelection"+b).show();}function startOver(b){$("#confirmationDiv"+b).html("false");editProductInformation(b);$("#resetLink").trigger("click");}function hideQuantityDiv(){$('input[id*="prod_quantity"]').each(function(){$(this).parent().remove();
});}function defaultMandatoryVDataQuantity(e,g){if(g!="true"){var h="#prod_quantity"+e;if($(h).val()=="0"||$(h).val()==""){$(h).val("1");var f=$("#PAGETYPE").html();if(f=="PPE_Graphical"){addOrUpdateDisabled=false;}}}}function populateConfirmationDivWhileNavigatingFromShoppingBag(b){if(b){$('div[id*="madeToMeasureConfirmationFragment"]').each(function(){$(this).show();
});$('div[id*="productOptions"]').each(function(){$(this).hide();});$('div[id*="productConfirmation"]').each(function(){$(this).hide();});$('div[id*="made_to_measure_lotskuSelection"]').each(function(){$(this).hide();});}else{$('div[id*="madeToMeasureConfirmationFragment"]').each(function(){$(this).hide();
});$('div[id*="productOptions"]').each(function(){$(this).show();});$('div[id*="productConfirmation"]').each(function(){$(this).hide();});$('div[id*="made_to_measure_lotskuSelection"]').each(function(){$(this).show();});}}function defaultQuantityForMTMFlow(d){if(d=="Empty"){$('input[id*="quantityForMTM"]').each(function(){if($(this).attr("value")=="0"||$(this).attr("value")==""){$(this).attr("value","1");
}});}else{var c=document.getElementById("quantityForMTM"+d).value;if(c=="0"||c==""){document.getElementById("quantityForMTM"+d).value=1;}}}function getMandatoryVData(){var h=new Array();var e="";var g="";try{$('form[id*="mandatoryVDataForm"]').each(function(){var c="";var b="";var d="";c=this.id.substring(18);
var a="#prod_quantity"+c;if(($(a).attr("value")!=0&&$(a).attr("value")!="")||$("#PAGETYPE").html()!="PPE_Graphical"){$(this).find('input[id*="enterValueForMandatoryVData"]').each(function(){b=$(this).attr("id");b=b.substr([b.lastIndexOf("_")+1]);d=$(this).attr("value");e+=c+"_"+b+"_"+d+",";});g+="GiftCard"+",";
}});}catch(f){redirectOnError();}h[0]=e;h[1]=g;return h;}var mandatoryVDataHasError=false;var atleastOneMandatoryPPHas=false;function validateMandatoryVData(k){removeErrorClass("1");atleastOneMandatoryPPHas=false;try{$('div[id*="vdataError"]').each(function(){$(this).empty();});$('div[id*="errorContainer"]').each(function(){$(this).hide();
});$('ul[id*="errorMessagesUL"]').each(function(){$(this).empty();});$('input[id*="prod_quantity"]').each(function(){$(this).removeClass("error");});}catch(e){handlejavaScriptError(e);}$("#errorContainer2").find("span").html("Please correct the errors listed in red above:");checkForMandatoryVData();var h="";
var j=getMandatoryVData();h=j[0];h=h.slice(0,h.length-1);$("#vDataEnsemble").val(h);var g={success:submitForMandatoryVData,error:error};globalButtonIndex=k;if($("#PAGETYPE").html()=="PPE_Graphical"&&!atleastOneMandatoryPPHas){if(k==2){$("#errorContainer"+k).find("span").html("Please correct the errors listed in red below:");
}$("#errorMessagesUL"+k).html("<li>Enter a valid quantity from 1-99.</li>");$("#errorContainer"+k).show();}else{if(!atleastOneMandatoryPPHas){$('input[id*="prod_quantity"]').each(function(){$(this).addClass("error");});}$("#vDataFormForEnsemble").attr("action","");$("#vDataFormForEnsemble").ajaxSubmit(g);
}callToCallMetric=true;}function setPpIdFromBrowse(b){ppIdFromBrowse=b;}function submitForMandatoryVData(r,p){mandatoryVDataHasError=false;var w=$("#PAGETYPE").html();if(r.errorPresent=="true"){if(w=="PPE_NonGraphical"||w=="PPE_Graphical"){$("#errorContainer"+globalButtonIndex).show();}$("#errorContainer0").hide();
mandatoryVDataHasError=true;try{for(var v=0;v<r.vdataErrorMessages.length;v++){var e=r.vdataErrorMessages[v].key;if(w=="PPE_Graphical"){var u="vdataError"+e;}else{var u="errorContainer";}if(r.vdataErrorMessages[v].validationErrors){if(w=="PPE_Graphical"){var o="#prod_quantity"+e;if($(o).attr("value")!=0&&$(o).attr("value")!=""){$("#"+u).html(r.vdataErrorMessages[v].validationErrors);
$("#"+u).find("span").remove();}var q=r.vdataErrorMessages[v].errorComponents.split("_");for(var t=0;t<q.length;t++){var n="enterValueForMandatoryVData_"+q[t];$("#"+e).find("input[id="+n+"]").each(function(){$(this).addClass("error");});}}else{if(!atleastOneMandatoryPPHas){$("#"+u).find("ul").html("<li>Enter a valid quantity from 1-99.</li>");
}var q=r.vdataErrorMessages[v].errorComponents.split("_");for(var t=0;t<q.length;t++){var n="enterValueForMandatoryVData_"+q[t];$("#"+n).addClass("error");}$("#"+u).find("ul").append($(r.vdataErrorMessages[v].validationErrors).find("ul").html());$("#"+u).show();}}}}catch(s){redirectOnError();}}else{$("#errorContainer"+globalButtonIndex).hide();
mandatoryVDataHasError=false;if(w=="PP_NonGraphical"||w=="PP_Graphical"||w=="LOT_Graphical"){if(atleastOneMandatoryPPHas){if(favAction==true){addToFavorite(ppIdFromBrowse);}else{addToCart();}}else{$("#"+"errorContainer").find("ul").html("<li>Enter a valid quantity from 1-99.</li>");$("#"+"errorContainer").show();
}}else{validateAndAddEnsembleItems(globalButtonIndex);}}}function removeErrorClass(d){try{if(d=="1"){$('input[id*="enterValueForMandatoryVData_"]').each(function(){$(this).removeClass("error");});}else{if(d=="2"){$('input[id*="enterValueFor"]').each(function(){$(this).removeClass("error");});$("select").each(function(){$(this).removeClass("error");
});}}}catch(c){handlejavaScriptError(c);}}function checkForMandatoryVData(){try{$('form[id*="mandatoryVDataForm"]').each(function(){var d="";d=this.id.substring(18);var a="#prod_quantity"+d;if($(a).attr("value")!=0&&$(a).attr("value")!=""){atleastOneMandatoryPPHas=true;}});}catch(b){handlejavaScriptError(b);
}}function checkForMTMColor(f){var e;try{e=$("#"+f+"COLORDisplay").html();if(e==undefined||e==""){return false;}}catch(d){handlejavaScriptError(d);}return true;}function hidemandatoryVData(){try{$('form[id*="mandatoryVDataForm"]').each(function(){$(this).remove();});}catch(b){handlejavaScriptError(b);
}}function clearColorForMTM(e){if($("#FROMBAG").html()=="true"){var e=$("#ppId").html();var g="#"+("selectedLotId"+e);var h="#"+("selectedSKUId"+e);var f=$("input#colorForMTM").attr("value");$(g).html($("#lotIdFromBag").html());$(h).html($("#skuIdFromBag").html());$('span[id$="COLORDisplay"]').each(function(){$(this).html(f);
$(this).next().attr("value",$("input#colorForMTM").attr("value"));});}else{$("#"+e+"COLORDisplay").each(function(){$(this).html("");$(this).next().attr("value","");$(this).parent().next().children('li[id*="img"]').each(function(){$(this).attr("class","");});});}}function MTMReset(c){$("#confirmationDiv"+c).html("false");
$("#productConfirmation"+c).hide();$("#made_to_measure_lotskuSelection"+c).show();$("#made_to_measure_form"+c).each(function(){this.reset();});clearColorForMTM(c);var d=$("#ChildType"+c).html();if(d!="MTM_ENSEMBLE"){defaultQuantityForMTMFlow(c);}$("#made_to_measure_form"+c).find("input").each(function(){$(this).removeClass("error");
});$("#made_to_measure_form"+c).find("select").each(function(){$(this).removeClass("error");});$("#quantityForMTM"+c).removeClass("error");}function handleVdataEnterKey(c){if(isEnterKey(c)){var d=document.getElementById("addtobag");d.focus();d.click();return false;}}function handleMonogramEnterKey(d){if(isEnterKey(d)){var c=document.getElementById("add_monogram");
c.click();return false;}}function isEnterKey(c){var d;if(window.event){d=window.event.keyCode;}else{d=c.which;}if(d!=13){return false;}else{return true;}}